# =============================================================================
# Agentic RAG Configuration
# =============================================================================
# Copy this file to .env and customize for your environment.

# -----------------------------------------------------------------------------
# Application
# -----------------------------------------------------------------------------
APP_NAME=Agentic RAG
APP_VERSION=0.1.0
ENVIRONMENT=dev  # dev | prod
LOG_LEVEL=INFO   # DEBUG | INFO | WARNING | ERROR

# -----------------------------------------------------------------------------
# Domain Configuration (change these to adapt to a different compliance domain)
# -----------------------------------------------------------------------------
DOMAIN_NAME=PDPL
DOMAIN_FULL_NAME=Personal Data Protection Law
DOMAIN_REGION=Saudi Arabia
DOMAIN_TOPICS=PDPL, privacy, and data protection
DOMAIN_CLOSING=Is there anything else I can help you with regarding PDPL compliance?

# -----------------------------------------------------------------------------
# API Server
# -----------------------------------------------------------------------------
API_HOST=0.0.0.0
API_PORT=8000

# -----------------------------------------------------------------------------
# Database (PostgreSQL + pgvector)
# -----------------------------------------------------------------------------
# Change these credentials before deploying to a shared or production environment.
POSTGRES_USER=postgres
POSTGRES_PASSWORD=changeme
POSTGRES_DB=ragdb
DATABASE_URL=postgresql+asyncpg://postgres:changeme@postgres:5432/ragdb
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=10

# -----------------------------------------------------------------------------
# Observability (Arize Phoenix)
# -----------------------------------------------------------------------------
# OTLP Trace Collector Endpoint (spans export)
PHOENIX_COLLECTOR_ENDPOINT=http://phoenix:6006/v1/traces
# Phoenix REST API base URL (prompt management)
PHOENIX_API_URL=http://phoenix:6006
PHOENIX_PROJECT_NAME=agentic-rag-v1

# Prompt management controls
PHOENIX_PROMPT_SYNC=true
PHOENIX_PROMPT_TAG=development

# PROMPTS_DIR=/app/config/prompts  # For Docker deployments

# -----------------------------------------------------------------------------
# LLM & Embeddings (Ollama)
# -----------------------------------------------------------------------------
OLLAMA_BASE_URL=http://ollama:11434
LLM_MODEL=qwen3:1.7b
LLM_TEMPERATURE=0.0        # 0.0 = deterministic, increase for more creative responses
EMBEDDING_MODEL=qwen3-embedding:0.6b
EMBEDDING_DIMENSION=1024
INDEX_VERSION=v1

# -----------------------------------------------------------------------------
# RAG Settings
# -----------------------------------------------------------------------------
CHUNK_SIZE=512
CHUNK_OVERLAP=50
TOP_K_RETRIEVAL=5
TOP_K_RERANK=5

# RRF fusion weights (tune precision vs recall)
RRF_WEIGHT_VECTOR=1.0
RRF_WEIGHT_KEYWORD=1.0

# Scope gate (off-topic rejection threshold, 0.0â€“1.0; higher = stricter)
SCOPE_GATE_THRESHOLD=0.55

# Reranker settings
RERANKER_TIMEOUT=30.0          # Falls back to retrieval order on timeout
RERANKER_MAX_PASSAGE_CHARS=2000  # Max chars sent to reranker per chunk
RERANK_CACHE_TTL=900
RERANK_CACHE_MAX=512
QUERY_EMBED_CACHE_TTL=900
PROMPT_CACHE_TTL_SECONDS=900
PROMPT_CACHE_MAX=512
SEMANTIC_CACHE_ENABLED=true
SEMANTIC_CACHE_TTL_SECONDS=604800
SEMANTIC_CACHE_MIN_SIMILARITY=0.92

# -----------------------------------------------------------------------------
# Evaluation (RAGAS)
# -----------------------------------------------------------------------------
EVAL_MODEL=qwen3:4b
EVAL_MAX_WORKERS=1    # Increase when using GPU or external API
EVAL_TIMEOUT=600      # Per-call timeout in seconds
EVAL_INTERVAL_SECONDS=3600

# -----------------------------------------------------------------------------
# CrewAI Settings
# -----------------------------------------------------------------------------
USE_CREWAI=true
CREWAI_TIMEOUT=120             # Agent timeout in seconds; falls back to direct RAG
FORCE_STREAMING=false          # Force all responses to stream (SSE)
CONVERSATION_HISTORY_LIMIT=10  # Number of past messages included in context
